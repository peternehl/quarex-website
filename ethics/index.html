<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ethics & Safety | Quarex</title>
  <meta name="description" content="Quarex Ethics & Safety Guidelines - How we protect users through multi-layer content filtering, AI safety, and transparency.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0A0A0A;
      --card: #111111;
      --text: #F7F7F7;
      --muted: #A0A0A0;
      --accent: #60a5fa;
      --accent-glow: rgba(96, 165, 250, 0.3);
      --border: #262626;
      --gold: #fbbf24;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.7;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 24px 80px;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 50px;
      padding-bottom: 30px;
      border-bottom: 1px solid var(--border);
    }

    .logo {
      width: 80px;
      height: 80px;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--text) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: var(--muted);
      font-size: 1.1rem;
      margin-bottom: 24px;
    }

    .header-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.95rem;
      transition: all 0.2s;
    }

    .btn-primary {
      background: var(--accent);
      color: #0A0A0A;
    }

    .btn-primary:hover {
      background: #7ab8ff;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: #1a1a1a;
      border-color: var(--accent);
    }

    /* Sections */
    .section {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 28px;
      margin-bottom: 24px;
    }

    h2 {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--accent);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    h2::before {
      content: '';
      width: 4px;
      height: 24px;
      background: var(--accent);
      border-radius: 2px;
    }

    h3 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-top: 20px;
      margin-bottom: 10px;
      color: var(--text);
    }

    h4 {
      font-size: 1rem;
      font-weight: 600;
      margin-top: 16px;
      margin-bottom: 8px;
      color: var(--muted);
    }

    p {
      color: var(--muted);
      margin-bottom: 12px;
    }

    strong {
      color: var(--text);
    }

    .highlight {
      background: rgba(96, 165, 250, 0.1);
      border: 1px solid rgba(96, 165, 250, 0.2);
      border-radius: 8px;
      padding: 16px;
      margin: 16px 0;
    }

    .highlight strong {
      color: var(--accent);
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
      font-size: 0.95rem;
    }

    th, td {
      border: 1px solid var(--border);
      padding: 12px;
      text-align: left;
    }

    th {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
      font-weight: 600;
    }

    td {
      color: var(--muted);
    }

    td strong {
      color: var(--text);
    }

    /* Lists */
    ul, ol {
      margin: 12px 0 12px 24px;
      color: var(--muted);
    }

    li {
      margin: 8px 0;
    }

    li strong {
      color: var(--text);
    }

    /* Code */
    code {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 8px;
      border-radius: 4px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 0.85em;
      color: var(--gold);
    }

    pre {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 0.85em;
      color: var(--muted);
      margin: 16px 0;
    }

    /* Links */
    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    /* Footer */
    .footer {
      text-align: center;
      padding-top: 40px;
      border-top: 1px solid var(--border);
      margin-top: 40px;
      color: var(--muted);
      font-size: 0.9rem;
    }

    /* Print styles */
    @media print {
      body {
        background: white;
        color: #333;
      }
      .section {
        background: white;
        border: 1px solid #ddd;
      }
      h1, h2 {
        color: #333;
        -webkit-text-fill-color: #333;
      }
      h2::before {
        background: #333;
      }
      p, td, li {
        color: #555;
      }
      .header-buttons {
        display: none;
      }
      code {
        background: #f5f5f5;
        color: #c53030;
      }
      pre {
        background: #f5f5f5;
        border-color: #ddd;
        color: #333;
      }
    }

    /* Mobile */
    @media (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
      }
      .section {
        padding: 20px;
      }
      table {
        font-size: 0.85rem;
      }
      th, td {
        padding: 8px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <a href="/"><img src="/assets/quarex-hero-round-500pixels.png" alt="Quarex" class="logo"></a>
    <h1>Ethics & Safety Guidelines</h1>
    <p class="subtitle">Technical Documentation | Version 1.0 | January 2025</p>
    <div class="header-buttons">
      <a href="Quarex-Ethics-and-Safety-Guidelines.pdf" download class="btn btn-primary">
        <svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16"><path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/><path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/></svg>
        Download PDF
      </a>
      <a href="/" class="btn btn-secondary">← Back to Quarex</a>
    </div>
  </div>

  <div class="section">
    <h2>1. Overview</h2>
    <p>Quarex implements a <strong>defense-in-depth</strong> security architecture to enable inquiry and learning while blocking content that could cause real-world harm. The system uses multiple layers of protection working in concert to ensure safe, educational interactions.</p>
    <div class="highlight">
      <strong>Core Philosophy:</strong> Enable genuine learning and exploration while preventing the generation of content related to weapons, exploitation, self-harm, fraud, and other harmful activities.
    </div>
  </div>

  <div class="section">
    <h2>2. Multi-Layer Content Filtering</h2>

    <h3>Layer 1: Pre-AI Regex Filtering</h3>
    <p>Before any query reaches the AI model (Gemini), it passes through a regex-based content filter. This immediately blocks queries matching known harmful patterns:</p>

    <table>
      <tr>
        <th>Category</th>
        <th>Examples Blocked</th>
      </tr>
      <tr>
        <td><strong>Violence & Weapons</strong></td>
        <td>Bomb-making instructions, poison synthesis, murder planning</td>
      </tr>
      <tr>
        <td><strong>Exploitation</strong></td>
        <td>Child exploitation material (CSAM), human trafficking</td>
      </tr>
      <tr>
        <td><strong>Terrorism</strong></td>
        <td>Attack planning, extremist recruitment, radicalization</td>
      </tr>
      <tr>
        <td><strong>Hacking & Fraud</strong></td>
        <td>Malware creation, identity theft, ransomware deployment</td>
      </tr>
      <tr>
        <td><strong>Self-Harm</strong></td>
        <td>Suicide methods, self-injury instructions</td>
      </tr>
    </table>

    <p>Blocked queries are logged to <code>security.log</code> for audit purposes but the query content is truncated to protect privacy.</p>

    <h3>Layer 2: AI System Instructions</h3>
    <p>The AI model receives explicit safety instructions in its system prompt:</p>
    <pre>"If a query requests information about illegal activities,
violence, exploitation, self-harm, or other harmful content,
begin your response with exactly [FLAGGED:SAFETY] followed
by a polite refusal explaining you cannot assist with that topic."</pre>
    <p>This catches queries that may slip past the regex filter through obfuscation or novel phrasing.</p>

    <h3>Layer 3: Response Detection</h3>
    <p>If the AI model flags a response with <code>[FLAGGED:SAFETY]</code>, the system intercepts this and returns a sanitized refusal message rather than passing through any potentially harmful content.</p>
  </div>

  <div class="section">
    <h2>3. Access Control</h2>

    <h3>Origin Validation</h3>
    <p>Strict CORS (Cross-Origin Resource Sharing) enforcement ensures only authorized domains can access the API:</p>
    <ul>
      <li><code>quarex.org</code> (production)</li>
      <li><code>localhost</code> (development only)</li>
    </ul>
    <p>Both the Origin header and Referer header are validated. Unauthorized requests receive HTTP 403 and are logged.</p>

    <h3>Rate Limiting</h3>
    <ul>
      <li><strong>Limit:</strong> 20 requests per 60 seconds per IP address</li>
      <li><strong>Purpose:</strong> Prevents abuse, denial-of-service attacks, and API cost runaway</li>
      <li><strong>Privacy:</strong> IP addresses are hashed before storage</li>
    </ul>
  </div>

  <div class="section">
    <h2>4. Security Logging & Audit</h2>
    <p>All security-relevant events are logged in JSON format:</p>

    <table>
      <tr>
        <th>Event Type</th>
        <th>Description</th>
      </tr>
      <tr>
        <td><code>BLOCKED_CONTENT</code></td>
        <td>Harmful query blocked by regex filter</td>
      </tr>
      <tr>
        <td><code>BLOCKED_ORIGIN</code></td>
        <td>Request from unauthorized domain</td>
      </tr>
      <tr>
        <td><code>BLOCKED_REFERER</code></td>
        <td>Request with suspicious referer header</td>
      </tr>
      <tr>
        <td><code>RATE_LIMITED</code></td>
        <td>IP exceeded request limit</td>
      </tr>
      <tr>
        <td><code>GEMINI_SAFETY_FLAG</code></td>
        <td>AI model flagged content as unsafe</td>
      </tr>
      <tr>
        <td><code>REQUEST</code></td>
        <td>Standard API request (for audit trail)</td>
      </tr>
    </table>

    <p><strong>Log Retention:</strong> 7 days maximum, 10MB file size limit with automatic cleanup.</p>
  </div>

  <div class="section">
    <h2>5. Educational Framing & Transparency</h2>

    <h3>Academic Positioning</h3>
    <p>The AI is instructed to operate as an educational assistant:</p>
    <pre>"You are an expert academic assistant.
Write at a clear 12th-grade level."</pre>
    <p>This positions responses as educational rather than authoritative, encouraging critical thinking.</p>

    <h3>Truth Over False Balance</h3>
    <p>Quarex prioritizes <strong>epistemic integrity</strong> over artificial neutrality. This means:</p>
    <ul>
      <li><strong>Facts are not negotiable:</strong> Scientific consensus, documented events, and verifiable evidence are presented as such—not as "one perspective among many"</li>
      <li><strong>No false equivalence:</strong> We do not present fringe theories alongside established facts as if they carry equal weight</li>
      <li><strong>Proportional representation:</strong> When legitimate debate exists, the weight given to different positions reflects the actual evidence supporting them</li>
      <li><strong>Transparency about uncertainty:</strong> Where genuine scientific or factual uncertainty exists, we acknowledge it clearly rather than manufacturing false certainty</li>
    </ul>
    <p>This approach rejects "both-sides-ism" that treats all claims as equally valid regardless of evidence. Truth-seeking requires distinguishing between well-supported conclusions and unsupported assertions.</p>

    <h3>Source Citation</h3>
    <p>Web-grounded responses include source URLs rendered as clickable links, enabling users to verify information independently.</p>

    <h3>Recency Bias</h3>
    <p>The system explicitly prioritizes current information:</p>
    <pre>"Always prioritize the most current and up-to-date information...
use the latest data from 2024-2025 whenever possible.
If information may have changed recently, explicitly note
the date or timeframe of your sources."</pre>

    <h3>Multilingual Support</h3>
    <p>13 languages supported including English, Spanish, French, German, Portuguese, Arabic, Hindi, Russian, Simplified Chinese, Traditional Chinese, Japanese, Korean, and Italian.</p>
  </div>

  <div class="section">
    <h2>6. Architecture Summary</h2>

    <div class="highlight">
      <strong>Request Flow:</strong>
      <ol>
        <li>Request arrives at API endpoint</li>
        <li>Origin/Referer validation (CORS)</li>
        <li>Rate limit check</li>
        <li>Regex content filter</li>
        <li>Query sent to Gemini AI with safety instructions</li>
        <li>Response checked for safety flags</li>
        <li>Clean response returned to user with sources</li>
      </ol>
    </div>

    <p>Each layer operates independently, ensuring that if one layer fails to catch harmful content, subsequent layers provide additional protection.</p>
  </div>

  <div class="section">
    <h2>7. AI Model: Gemini 2.5 Flash</h2>
    <p>Quarex uses Google's Gemini 2.5 Flash-Lite with Google Search grounding for factual accuracy.</p>

    <h3>Gemini's Built-In Safety Framework</h3>
    <p>Google's Gemini models include their own safety layer, designed to be "maximally helpful to users, while avoiding outputs that could cause real-world harm or offense." This provides an additional safety net beyond Quarex's custom filtering.</p>

    <h4>Gemini Prohibited Content Categories</h4>
    <table>
      <tr>
        <th>Category</th>
        <th>Policy</th>
      </tr>
      <tr>
        <td><strong>Child Safety</strong></td>
        <td>Cannot generate CSAM or content that exploits/sexualizes minors</td>
      </tr>
      <tr>
        <td><strong>Dangerous Activities</strong></td>
        <td>No suicide/self-harm instructions, illegal drug facilitation, or weapon-building guides</td>
      </tr>
      <tr>
        <td><strong>Violence & Gore</strong></td>
        <td>Restricted excessive blood, gore, injuries, and gratuitous violence</td>
      </tr>
      <tr>
        <td><strong>Harmful Misinformation</strong></td>
        <td>No medical claims contradicting scientific consensus; no false safety information</td>
      </tr>
      <tr>
        <td><strong>Harassment & Hate</strong></td>
        <td>No content calling for violence against individuals/groups; no dehumanizing statements</td>
      </tr>
      <tr>
        <td><strong>Sexual Content</strong></td>
        <td>No pornography, erotic material, or depictions of sexual assault</td>
      </tr>
    </table>

    <h4>Frontier Safety Framework (FSF)</h4>
    <p>Google's Gemini 2.5 models are evaluated under their Frontier Safety Framework, which addresses risks of severe harm in four key domains:</p>
    <ul>
      <li><strong>CBRN:</strong> Chemical, biological, radiological, and nuclear information risks</li>
      <li><strong>Cybersecurity:</strong> Prevention of malicious hacking assistance</li>
      <li><strong>Autonomy:</strong> Limits on autonomous agent capabilities</li>
      <li><strong>Persuasion:</strong> Safeguards against manipulation</li>
    </ul>

    <h4>Configurable Safety Thresholds</h4>
    <p>The Gemini API provides configurable harm block thresholds:</p>
    <ul>
      <li><code>BLOCK_LOW_AND_ABOVE</code> - Most restrictive (blocks LOW, MEDIUM, HIGH probability)</li>
      <li><code>BLOCK_MEDIUM_AND_ABOVE</code> - Moderate (blocks MEDIUM and HIGH)</li>
      <li><code>BLOCK_ONLY_HIGH</code> - Least restrictive (blocks only HIGH probability)</li>
    </ul>

    <p><em>Source: <a href="https://gemini.google/policy-guidelines/" target="_blank">Google Gemini Policy Guidelines</a></em></p>
  </div>

  <div class="footer">
    <p><strong>Quarex</strong> | <a href="https://quarex.org">quarex.org</a><br>
    &copy; 2025 Peter Nehl. All Rights Reserved.</p>
  </div>
</div>

</body>
</html>
